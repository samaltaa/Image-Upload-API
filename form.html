<!DOCTYPE html>
<html>
<head>
    <title>Submit Info</title>
    <style>
        body {
            background-color: #0a0a0f;
            font-family: 'Courier New', monospace;
            color: #f8f8ff;
            
        }
    
        .card {
            border: 1px solid #00ffe7;
            background-color: #151515;
            color: #f0f0f0;
            padding: 12px;
            margin-top: 10px;
            max-width: 300px;
            box-shadow: 0 0 10px #00ffe7;
            border-radius: 8px;
            transition: transform 0.2s;
        }
    
        .card:hover {
            transform: scale(1.03);
            box-shadow: 0 0 12px #ff00ff;
        }
    
        .card strong {
            color: #39ff14;
        }
    
        .card img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ff00ff;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        #subjects-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        #subject-form{
            background-color: #151515;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px #00ffe7;
            margin-bottom: 20px;
        }
        .labels {
            color: #00ffe7;
            font-weight: bold;
        }
        .image-input {
            color: #00ffe7;
            background-color: #151515;
            border: 1px solid #00ffe7;
            padding: 5px;
            border-radius: 4px;
        }
        .button {
            background-color: #00ffe7;
            color: #151515;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        .h2 {
            color: #00ffe7;
            text-align: center;
            margin-top: 20px;
        }
        
    </style>
    
</head>
<body>
    <h2 class="h2">Submit Info</h2>
    <form id="subject-form" enctype="multipart/form-data">
        <label class="labels">ID:</label><br>
        <input type="text" name="id" required><br><br>
        <label class="labels">First Name:</label><br>
        <input type="text" name="first_name" required><br><br>

        <label class="labels">Last Name:</label><br>
        <input type="text" name="last_name" required><br><br>

        <label class="labels" >Date of Birth:</label><br>
        <input type="date" name="dob" required><br><br>

        <label class="labels">Upload Image:</label><br>
        <input class="image-input" type="file" name="image" accept="image/*" required><br><br>

        <input class="button" type="submit" value="Submit">
    </form>

    <h2 class="h2">Registered:</h2>
    <div id="subjects-container"></div>

    <script>
        const form = document.getElementById("subject-form");
        const container = document.getElementById("subjects-container");

        form.addEventListener("submit", async function (e) {
            e.preventDefault();

            const formData = new FormData(form);

            const response = await fetch("http://127.0.0.1:8000/subjects/", {
                method: "POST",
                body: formData
            });

            if (response.ok) {
                alert("Subject added!");
                form.reset();
                loadSubjects(); // refresh card list
            } else {
                const err = await response.json();
                alert("Error: " + err.detail);
            }
        });

        async function loadSubjects() {
            const res = await fetch("http://127.0.0.1:8000/subjects/");
            const data = await res.json();

            container.innerHTML = "";
            data.forEach(subject => {
                const card = document.createElement("div");
                card.className = "card";

                const img = document.createElement("img");
                if (subject.image) {
                    img.src = `data:image/jpeg;base64,${subject.image}`;
                    card.appendChild(img);
                }

                card.innerHTML += `
                    <strong>${subject.first_name} ${subject.last_name}</strong><br>
                    DOB: ${subject.dob}<br>
                    ID: ${subject.id}<br>
                `;
                
                container.appendChild(card);
            });
        }

        loadSubjects(); // Load on page load
    </script>
</body>
</html>
